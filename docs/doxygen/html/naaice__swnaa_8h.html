<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>naa-communication-prototype: /Users/hannessigner/Documents/Work/naa-communication-prototype/lib/naaice_swnaa.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">naa-communication-prototype<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">Library for NAA communication via RoCEv2</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">naaice_swnaa.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="naaice_8h_source.html">naaice.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for naaice_swnaa.h:</div>
<div class="dyncontent">
<div class="center"><img src="naaice__swnaa_8h__incl.png" border="0" usemap="#a_2Users_2hannessigner_2Documents_2Work_2naa-communication-prototype_2lib_2naaice__swnaa_8h" alt=""/></div>
</div>
</div>
<p><a href="naaice__swnaa_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2e304ccf78229d70b893def6eea01844" id="r_a2e304ccf78229d70b893def6eea01844"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2e304ccf78229d70b893def6eea01844">naaice_swnaa_init_communication_context</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> **comm_ctx, uint16_t port)</td></tr>
<tr class="separator:a2e304ccf78229d70b893def6eea01844"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8a7cefb12eee651c6c055220bf0fc67" id="r_af8a7cefb12eee651c6c055220bf0fc67"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af8a7cefb12eee651c6c055220bf0fc67">naaice_swnaa_setup_connection</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="separator:af8a7cefb12eee651c6c055220bf0fc67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a090aa5dad1a291e1331e970071aa65d7" id="r_a090aa5dad1a291e1331e970071aa65d7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a090aa5dad1a291e1331e970071aa65d7">naaice_swnaa_handle_connection_requests</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx, struct rdma_cm_event *ev)</td></tr>
<tr class="separator:a090aa5dad1a291e1331e970071aa65d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a035fce0f94485bed8bd89298b0a275c9" id="r_a035fce0f94485bed8bd89298b0a275c9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a035fce0f94485bed8bd89298b0a275c9">naaice_swnaa_handle_connection_established</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx, struct rdma_cm_event *ev)</td></tr>
<tr class="separator:a035fce0f94485bed8bd89298b0a275c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad193f2b7634c79cb88f88d45f403a9c5" id="r_ad193f2b7634c79cb88f88d45f403a9c5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad193f2b7634c79cb88f88d45f403a9c5">naaice_swnaa_handle_error</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx, struct rdma_cm_event *ev)</td></tr>
<tr class="separator:ad193f2b7634c79cb88f88d45f403a9c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accd16824d60b2f865b90e13720b271fa" id="r_accd16824d60b2f865b90e13720b271fa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#accd16824d60b2f865b90e13720b271fa">naaice_swnaa_poll_and_handle_connection_event</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="separator:accd16824d60b2f865b90e13720b271fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12c843653bf1a3e09d3dfea183ae2c87" id="r_a12c843653bf1a3e09d3dfea183ae2c87"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a12c843653bf1a3e09d3dfea183ae2c87">naaice_swnaa_init_mrsp</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="separator:a12c843653bf1a3e09d3dfea183ae2c87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c8a63de324d43fac3d053f4a49ff17b" id="r_a0c8a63de324d43fac3d053f4a49ff17b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0c8a63de324d43fac3d053f4a49ff17b">naaice_swnaa_post_recv_mrsp</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="separator:a0c8a63de324d43fac3d053f4a49ff17b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abac978fd0af33cd063e701ce16f681f6" id="r_abac978fd0af33cd063e701ce16f681f6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abac978fd0af33cd063e701ce16f681f6">naaice_swnaa_handle_work_completion</a> (struct ibv_wc *wc, struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="separator:abac978fd0af33cd063e701ce16f681f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a788ed844b1653b50572d9e42dc7a0a68" id="r_a788ed844b1653b50572d9e42dc7a0a68"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a788ed844b1653b50572d9e42dc7a0a68">naaice_swnaa_handle_mr_announce</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="separator:a788ed844b1653b50572d9e42dc7a0a68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48579f2e7e439235f9247f07465a97bd" id="r_a48579f2e7e439235f9247f07465a97bd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a48579f2e7e439235f9247f07465a97bd">naaice_swnaa_handle_mr_announce_and_request</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="separator:a48579f2e7e439235f9247f07465a97bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37454381c7d8b6a8789a59cc1b3be774" id="r_a37454381c7d8b6a8789a59cc1b3be774"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a37454381c7d8b6a8789a59cc1b3be774">naaice_swnaa_send_message</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx, enum <a class="el" href="naaice_8h.html#a5f2be45182f0cc39afb7cc3a8d55a1f1">message_id</a> message_type, uint8_t errorcode)</td></tr>
<tr class="separator:a37454381c7d8b6a8789a59cc1b3be774"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42d9e03575369193d4b439dc14cd9996" id="r_a42d9e03575369193d4b439dc14cd9996"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a42d9e03575369193d4b439dc14cd9996">naaice_swnaa_post_recv_data</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="separator:a42d9e03575369193d4b439dc14cd9996"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad097a9b0b5c21da11b75ca5e41d5eabe" id="r_ad097a9b0b5c21da11b75ca5e41d5eabe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad097a9b0b5c21da11b75ca5e41d5eabe">naaice_swnaa_write_data</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx, uint8_t errorcode)</td></tr>
<tr class="separator:ad097a9b0b5c21da11b75ca5e41d5eabe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8de430c646b492b2ed48e02b5c605a98" id="r_a8de430c646b492b2ed48e02b5c605a98"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8de430c646b492b2ed48e02b5c605a98">naaice_swnaa_disconnect_and_cleanup</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="separator:a8de430c646b492b2ed48e02b5c605a98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae641aa93b2c8bb44a7346cbc6df59560" id="r_ae641aa93b2c8bb44a7346cbc6df59560"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae641aa93b2c8bb44a7346cbc6df59560">naaice_swnaa_do_mrsp</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="separator:ae641aa93b2c8bb44a7346cbc6df59560"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29754b79027796b544949dddc0966588" id="r_a29754b79027796b544949dddc0966588"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a29754b79027796b544949dddc0966588">naaice_swnaa_receive_data_transfer</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="separator:a29754b79027796b544949dddc0966588"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcd7cfac00b5a22c00bfa9232951e762" id="r_afcd7cfac00b5a22c00bfa9232951e762"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afcd7cfac00b5a22c00bfa9232951e762">naaice_swnaa_do_data_transfer</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx, uint8_t errorcode)</td></tr>
<tr class="separator:afcd7cfac00b5a22c00bfa9232951e762"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a699965b5aacdf718be4c95ac910a16cc" id="r_a699965b5aacdf718be4c95ac910a16cc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a699965b5aacdf718be4c95ac910a16cc">naaice_swnaa_poll_cq_nonblocking</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="separator:a699965b5aacdf718be4c95ac910a16cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a8de430c646b492b2ed48e02b5c605a98" name="a8de430c646b492b2ed48e02b5c605a98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8de430c646b492b2ed48e02b5c605a98">&#9670;&#160;</a></span>naaice_swnaa_disconnect_and_cleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_swnaa_disconnect_and_cleanup </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>naaice_swnaa_disconnect_and_cleanup: Terminates the connection and frees all communication context memory.</p>
<p>params: <a class="el" href="structnaaice__communication__context.html" title="Communication context for NAA connections.">naaice_communication_context</a> *comm_ctx: Pointer to struct describing the connection.</p>
<p>returns: 0 if sucessful, -1 if not. </p>

</div>
</div>
<a id="afcd7cfac00b5a22c00bfa9232951e762" name="afcd7cfac00b5a22c00bfa9232951e762"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcd7cfac00b5a22c00bfa9232951e762">&#9670;&#160;</a></span>naaice_swnaa_do_data_transfer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_swnaa_do_data_transfer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>errorcode</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>naaice_swnaa_do_data_transfer Does all logic for the data transfer, including recieving data from the NAA, wating for the NAA calculation, and writing the return data back, in a blocking fashion.</p>
<p>params: <a class="el" href="structnaaice__communication__context.html" title="Communication context for NAA connections.">naaice_communication_context</a> *comm_ctx: Pointer to struct describing the connection.</p>
<p>returns: 0 if successful, -1 if not. </p>

</div>
</div>
<a id="ae641aa93b2c8bb44a7346cbc6df59560" name="ae641aa93b2c8bb44a7346cbc6df59560"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae641aa93b2c8bb44a7346cbc6df59560">&#9670;&#160;</a></span>naaice_swnaa_do_mrsp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_swnaa_do_mrsp </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>naaice_swnaa_do_mrsp Does all logic for the MRSP in a blocking fashion.</p>
<p>params: <a class="el" href="structnaaice__communication__context.html" title="Communication context for NAA connections.">naaice_communication_context</a> *comm_ctx: Pointer to struct describing the connection.</p>
<p>returns: 0 if successful, -1 if not. </p>

</div>
</div>
<a id="a035fce0f94485bed8bd89298b0a275c9" name="a035fce0f94485bed8bd89298b0a275c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a035fce0f94485bed8bd89298b0a275c9">&#9670;&#160;</a></span>naaice_swnaa_handle_connection_established()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_swnaa_handle_connection_established </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct rdma_cm_event *</td>          <td class="paramname"><span class="paramname"><em>ev</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a090aa5dad1a291e1331e970071aa65d7" name="a090aa5dad1a291e1331e970071aa65d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a090aa5dad1a291e1331e970071aa65d7">&#9670;&#160;</a></span>naaice_swnaa_handle_connection_requests()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_swnaa_handle_connection_requests </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct rdma_cm_event *</td>          <td class="paramname"><span class="paramname"><em>ev</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>swnaa connection event handlers: These functions each handle a specific connection event. If the provided event's type matches the event type of the handler function, it executes the necessary logic to handle it.</p>
<p>Subsequently, flags in the communication context are updated to represent the current status of connection establishment.</p>
<p>The events handled by these functions are, in order: RDMA_CM_EVENT_CONNECTION_REQUEST RDMA_CM_EVENT_CONNECT_ESTABLISHED</p>
<p>Also, the following are handled by naaice_swnaa_handle_error: RDMA_CM_EVENT_ADDR_ERROR, RDMA_CM_EVENT_ROUTE_ERROR, RDMA_CM_EVENT_CONNECT_ERROR, RDMA_CM_EVENT_UNREACHABLE, RDMA_CM_EVENT_REJECTED, RDMA_CM_EVENT_DEVICE_REMOVAL, RDMA_CM_EVENT_DISCONNECTED.</p>
<p>params: <a class="el" href="structnaaice__communication__context.html" title="Communication context for NAA connections.">naaice_communication_context</a> *comm_ctx: Pointer to struct describing the connection with events to handle. struct rdma_cm_event *ev: Pointer to event to be checked and possibly handled.</p>
<p>returns: 0 if sucessful (i.e. either the event was the matching type and was handled successfully, or the event was not the matching type), -1 if not. </p>

</div>
</div>
<a id="ad193f2b7634c79cb88f88d45f403a9c5" name="ad193f2b7634c79cb88f88d45f403a9c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad193f2b7634c79cb88f88d45f403a9c5">&#9670;&#160;</a></span>naaice_swnaa_handle_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_swnaa_handle_error </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct rdma_cm_event *</td>          <td class="paramname"><span class="paramname"><em>ev</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a788ed844b1653b50572d9e42dc7a0a68" name="a788ed844b1653b50572d9e42dc7a0a68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a788ed844b1653b50572d9e42dc7a0a68">&#9670;&#160;</a></span>naaice_swnaa_handle_mr_announce()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_swnaa_handle_mr_announce </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>naaice_swnaa_handle_mr_announce, naaice_swnaa_handle_mr_announce_and_request:</p>
<p>Handlers for MRSP packets. Processes the contents of a received MRSP packet of the corresponding type, populating relevant values in the communication context.</p>
<p>params: <a class="el" href="structnaaice__communication__context.html" title="Communication context for NAA connections.">naaice_communication_context</a> *comm_ctx: Pointer to struct describing the connection.</p>
<p>returns: 0 if sucessful, -1 if not. </p>

</div>
</div>
<a id="a48579f2e7e439235f9247f07465a97bd" name="a48579f2e7e439235f9247f07465a97bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48579f2e7e439235f9247f07465a97bd">&#9670;&#160;</a></span>naaice_swnaa_handle_mr_announce_and_request()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_swnaa_handle_mr_announce_and_request </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="abac978fd0af33cd063e701ce16f681f6" name="abac978fd0af33cd063e701ce16f681f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abac978fd0af33cd063e701ce16f681f6">&#9670;&#160;</a></span>naaice_swnaa_handle_work_completion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_swnaa_handle_work_completion </td>
          <td>(</td>
          <td class="paramtype">struct ibv_wc *</td>          <td class="paramname"><span class="paramname"><em>wc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>naaice_swnaa_handle_work_completion: Handles a single work completion from the completion queue. These represent memory region writes from host to NAA or NAA to host.</p>
<p>params: <a class="el" href="structnaaice__communication__context.html" title="Communication context for NAA connections.">naaice_communication_context</a> *comm_ctx: Pointer to struct describing the connection.</p>
<p>returns: 0 if sucessful, -1 if not. </p>

</div>
</div>
<a id="a2e304ccf78229d70b893def6eea01844" name="a2e304ccf78229d70b893def6eea01844"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e304ccf78229d70b893def6eea01844">&#9670;&#160;</a></span>naaice_swnaa_init_communication_context()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_swnaa_init_communication_context </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> **</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>port</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>7MN.</code>7MF' db db &lsquo;7MMF&rsquo; .g8"""bgd `7MM"""YMM <br  />
 MMN. M ;MM: ;MM: MM .dP' <code>M MM</code>7 <br  />
 M YMb M ,V^MM. ,V^MM. MM dM' <code>MM d \ilinebr&lt;br&gt; M</code>MN. M ,M <code>MM ,M</code>MM MM MM MMmmMM <br  />
 M &lsquo;MM.M AbmmmqMA AbmmmqMA MM MM. MM Y , M YMM A&rsquo; VML A' VML MM &lsquo;Mb. ,&rsquo; MM ,M .JML. YM .AMA. .AMMA..AMA. .AMMA..JMML. &lsquo;"bmmmd&amp;rsquo;  .JMMmmmmMMM 

 Network-Attached Accelerators for Energy-Efficient Heterogeneous Computing

naaice_swnaa.h

Interface for NAAICE AP1 software dummy NAA (SWNAA).

These functions are used to set up a software mockup of an NAA, which
behaves like a FPGA-based NAA should. Such an SWNAA can be used for testing
the NAAICE middleware layers in the absence of an FPGA.

Florian Mikolajczak, florian.mikolajczak@uni-potsdam.de
Dylan Everingham, everingham@zib.de

26-01-2024
naaice_init_communication_context:
 Initializes communication context struct.

 The dummy software NAA reuses the communication context struct from the
 host-side AP1 implementation, but doesn't use all the fields in the
 exact same way. Most importantly, the size and number of parameters
 is not known (and related fields are not populated) until after the
 MRSP is complete.

params:
 naaice_communication_context *comm_ctx: (return param)
   Pointer to communication context struct to be initialized.
   Should not point to an existing struct; the struct is allocated
   and returned by this function.
 const char *port:
   String specifying connection port, ex. "12345". about:blank#blocked returns: 0 if sucessful, -1 if not. </p>

</div>
</div>
<a id="a12c843653bf1a3e09d3dfea183ae2c87" name="a12c843653bf1a3e09d3dfea183ae2c87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12c843653bf1a3e09d3dfea183ae2c87">&#9670;&#160;</a></span>naaice_swnaa_init_mrsp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_swnaa_init_mrsp </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>naaice_swnaa_init_mrsp: Starts the MRSP on the NAA side. That is, posts a recieve for MRSP packets expected from the host.</p>
<p>params: <a class="el" href="structnaaice__communication__context.html" title="Communication context for NAA connections.">naaice_communication_context</a> *comm_ctx: Pointer to struct describing the connection and memory regions.</p>
<p>returns: 0 if sucessful, -1 if not. </p>

</div>
</div>
<a id="accd16824d60b2f865b90e13720b271fa" name="accd16824d60b2f865b90e13720b271fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accd16824d60b2f865b90e13720b271fa">&#9670;&#160;</a></span>naaice_swnaa_poll_and_handle_connection_event()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_swnaa_poll_and_handle_connection_event </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>naaice_swnaa_poll_and_handle_connection_event: Polls for a connection event on the RDMA event channel stored in the communication context and handles the event if one is received. Simply uses the poll and handle functions above.</p>
<p>params: <a class="el" href="structnaaice__communication__context.html" title="Communication context for NAA connections.">naaice_communication_context</a> *comm_ctx: Pointer to struct describing the connection.</p>
<p>returns: 0 if sucessful (regardless of whether an event is received), -1 if not. </p>

</div>
</div>
<a id="a699965b5aacdf718be4c95ac910a16cc" name="a699965b5aacdf718be4c95ac910a16cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a699965b5aacdf718be4c95ac910a16cc">&#9670;&#160;</a></span>naaice_swnaa_poll_cq_nonblocking()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_swnaa_poll_cq_nonblocking </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>naaice_swnaa_poll_cq_nonblocking: Polls the completion queue for any work completions, and handles them if any are received using naaice_handle_work_completion.</p>
<p>Subsequently, comm_ctx-&gt;state is updated to reflect the current state of the NAA connection and routine.</p>
<p>params: <a class="el" href="structnaaice__communication__context.html" title="Communication context for NAA connections.">naaice_communication_context</a> *comm_ctx: Pointer to struct describing the connection.</p>
<p>returns: 0 if sucessful (regardless of whether any work completions are received), -1 if not. </p>

</div>
</div>
<a id="a42d9e03575369193d4b439dc14cd9996" name="a42d9e03575369193d4b439dc14cd9996"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42d9e03575369193d4b439dc14cd9996">&#9670;&#160;</a></span>naaice_swnaa_post_recv_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_swnaa_post_recv_data </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>naaice_swnaa_post_recv_data Posts a recieve for a memory region write. It is only necessary to post a recieve for the final memory region to be written, that is, the write with an immediate value. RDMA writes without an immediate simply occur without consuming a recieve request in the queue.</p>
<p>The memory region specified in the recieve request is the MRSP region; this is just a dummy value, as the region written to is specified by the sender.</p>
<p>params: <a class="el" href="structnaaice__communication__context.html" title="Communication context for NAA connections.">naaice_communication_context</a> *comm_ctx: Pointer to struct describing the connection.</p>
<p>returns: 0 if successful, -1 if not. </p>

</div>
</div>
<a id="a0c8a63de324d43fac3d053f4a49ff17b" name="a0c8a63de324d43fac3d053f4a49ff17b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c8a63de324d43fac3d053f4a49ff17b">&#9670;&#160;</a></span>naaice_swnaa_post_recv_mrsp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_swnaa_post_recv_mrsp </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>naaice_swnaa_post_recv_mrsp Posts a recieve for an MRSP message. A recieve request is added to the queue which specifies the memory region to be written to (in this case, the MRSP region).</p>
<p>params: <a class="el" href="structnaaice__communication__context.html" title="Communication context for NAA connections.">naaice_communication_context</a> *comm_ctx: Pointer to struct describing the connection.</p>
<p>returns: 0 if successful, -1 if not. </p>

</div>
</div>
<a id="a29754b79027796b544949dddc0966588" name="a29754b79027796b544949dddc0966588"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29754b79027796b544949dddc0966588">&#9670;&#160;</a></span>naaice_swnaa_receive_data_transfer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_swnaa_receive_data_transfer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>naaice_swnaa_receive_data_transfer Handles recieving data from remote peer, blocking until this is finished. Information about the data is updated in the communication context.</p>
<p>params: <a class="el" href="structnaaice__communication__context.html" title="Communication context for NAA connections.">naaice_communication_context</a> *comm_ctx: Pointer to struct describing the connection.</p>
<p>returns: 0 if successful, -1 if not. </p>

</div>
</div>
<a id="a37454381c7d8b6a8789a59cc1b3be774" name="a37454381c7d8b6a8789a59cc1b3be774"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37454381c7d8b6a8789a59cc1b3be774">&#9670;&#160;</a></span>naaice_swnaa_send_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_swnaa_send_message </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="naaice_8h.html#a5f2be45182f0cc39afb7cc3a8d55a1f1">message_id</a></td>          <td class="paramname"><span class="paramname"><em>message_type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>errorcode</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>naaice_swnaa_send_message: Sends an MRSP packet to the remote peer. Done with a ibv_post_send using opcode IBV_WR_SEND.</p>
<p>params: <a class="el" href="structnaaice__communication__context.html" title="Communication context for NAA connections.">naaice_communication_context</a> *comm_ctx: Pointer to struct describing the connection. enum <a class="el" href="naaice_8h.html#a5f2be45182f0cc39afb7cc3a8d55a1f1" title="Message IDs used for packets sent between host and NAA.">message_id</a> message_type: Specifies the packet type. Should be one of MSG_MR_ERR, MSG_MR_AAR, or MSG_MR_A. uint8_t errorcode: Error code send in the packet, if message_type was MSG_MR_ERR. Unused for other message types.</p>
<p>returns: 0 if sucessful, -1 if not. </p>

</div>
</div>
<a id="af8a7cefb12eee651c6c055220bf0fc67" name="af8a7cefb12eee651c6c055220bf0fc67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8a7cefb12eee651c6c055220bf0fc67">&#9670;&#160;</a></span>naaice_swnaa_setup_connection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_swnaa_setup_connection </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>naaice_swnaa_setup_connection: Loops polling for and handling connection events until connection setup is complete. Unlike the base naaice version, does not require handling the address or route resolution events, but does handle the connection requests complete event which is not handled on the host side.</p>
<p>params: <a class="el" href="structnaaice__communication__context.html" title="Communication context for NAA connections.">naaice_communication_context</a> *comm_ctx: Pointer to struct describing the connection.</p>
<p>returns: 0 if sucessful, -1 if not (due to timeout). </p>

</div>
</div>
<a id="ad097a9b0b5c21da11b75ca5e41d5eabe" name="ad097a9b0b5c21da11b75ca5e41d5eabe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad097a9b0b5c21da11b75ca5e41d5eabe">&#9670;&#160;</a></span>naaice_swnaa_write_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_swnaa_write_data </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>errorcode</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>naaice_swnaa_write_data: Writes the return memory region, specified by comm_ctx-&gt;mr_return_idx, to the remote peer. Done with a ibv_post_send using opcode IBV_WR_RDMA_WRITE_WITH_IMM. The immediate value indicates if an error has occured during calculation (nonzero = error).</p>
<p>params: <a class="el" href="structnaaice__communication__context.html" title="Communication context for NAA connections.">naaice_communication_context</a> *comm_ctx: Pointer to struct describing the connection. uint8_t fncode: Function Code for NAA routine. Positive, 0 on error.</p>
<p>returns: 0 if sucessful, -1 if not. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2
</small></address>
</div><!-- doc-content -->
</body>
</html>
