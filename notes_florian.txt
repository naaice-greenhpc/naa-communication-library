
Dear Florian,

I refactored a lot of the AP1 code, taking into account your recent changes,
in order to facilitate non-blocking behavior and AP2 functionality. Also, I
tried to make it more readable, documented, and maintainable in general.

All of these changes are of course up to decision, and I can roll back anything
you don't like.


As a result, I've renamed or removed some functions. Find below some notes
about where the innards of various functions have been moved:

naaice_prepare_connection: functionality split between new functions
	naaice_init_communication_context and naaice_register_mrs.

naaice_on_event_client:	event loop rewritten and moved to new function
	naaice_setup_connection.

naaice_on_addr_resolved: moved to new function naaice_handle_addr_resolved.

naaice_on_route_resolved: moved to new function naaice_handle_route_resolved.

naaice_on_connection_requests: moved to new function
	naaice_handle_on_connection_requests.

naaice_on_connection_client: split between new functions
	naaice_handle_connection_established,
	naaice_register_mrs, and naaice_init_mrsp.

naaice_configure_metadata: rewritten as new function naaice_set_metadata.

naaice_poll_cq: rewritten as new functions naaice_poll_cq_nonblocking and
	naaice_poll_cq_blocking.

naaice_on_completion_client: moved to naaice_handle_work_completion.

naaice_send_message: still used.

naaice_write_data_client: renamed to naaice_write_data.

naaice_post_recv: still used.

naaice_on_disconnect: moved to new function naaice_disconnect_and_cleanup.



naaice_on_event_server:

naaice_write_data_server:

naaice_handle_mr_announce: 

naaice_handle_mr_announce_and_req:

naaice_on_connection_server:

naaice_on_completion_server:

naaice_handle_metadata:

naaice_mr_exchange: seems to have already been removed, not called anywhere in
	naaice.c
