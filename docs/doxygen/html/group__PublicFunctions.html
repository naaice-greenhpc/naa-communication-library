<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>naa-communication-prototype: Functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">naa-communication-prototype<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">Library for NAA communication via RoCEv2</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Topics</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Functions</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Functions:</div>
<div class="dyncontent">
<div class="center"><img src="group__PublicFunctions.png" border="0" usemap="#agroup____PublicFunctions" alt=""/></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="groups" name="groups"></a>
Topics</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__connection__event__handlers.html">Connection event handlers</a></td></tr>
<tr class="memdesc:group__connection__event__handlers"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handlers for RDMA connection management events. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga6f3ba43a0744d3118a6fb194503eb63e" id="r_ga6f3ba43a0744d3118a6fb194503eb63e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga6f3ba43a0744d3118a6fb194503eb63e">naaice_init_communication_context</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> **comm_ctx, uint64_t addr_offset, size_t *param_sizes, char **params, unsigned int params_amount, unsigned int internal_mr_amount, size_t *internal_mr_sizes, uint8_t fncode, const char *local_address, const char *remote_address, uint16_t port)</td></tr>
<tr class="memdesc:ga6f3ba43a0744d3118a6fb194503eb63e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes communication context struct.  <br /></td></tr>
<tr class="separator:ga6f3ba43a0744d3118a6fb194503eb63e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf2fe88c227bab4e0722365efc2dba892" id="r_gaf2fe88c227bab4e0722365efc2dba892"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaf2fe88c227bab4e0722365efc2dba892">naaice_poll_connection_event</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx, struct rdma_cm_event *ev, struct rdma_cm_event *ev_cp)</td></tr>
<tr class="memdesc:gaf2fe88c227bab4e0722365efc2dba892"><td class="mdescLeft">&#160;</td><td class="mdescRight">Polls for a connection event on the RDMA event channel.  <br /></td></tr>
<tr class="separator:gaf2fe88c227bab4e0722365efc2dba892"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga241fe974872b43327aa2bb3f8fcf56c9" id="r_ga241fe974872b43327aa2bb3f8fcf56c9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga241fe974872b43327aa2bb3f8fcf56c9">naaice_poll_and_handle_connection_event</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="memdesc:ga241fe974872b43327aa2bb3f8fcf56c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Poll and handle a connection event on the RDMA event channel.  <br /></td></tr>
<tr class="separator:ga241fe974872b43327aa2bb3f8fcf56c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga41cae89395d0303a73aa675c9be5ed05" id="r_ga41cae89395d0303a73aa675c9be5ed05"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga41cae89395d0303a73aa675c9be5ed05">naaice_setup_connection</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="memdesc:ga41cae89395d0303a73aa675c9be5ed05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up the RDMA connection.  <br /></td></tr>
<tr class="separator:ga41cae89395d0303a73aa675c9be5ed05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae242db34a7bfaea52853646886269fca" id="r_gae242db34a7bfaea52853646886269fca"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gae242db34a7bfaea52853646886269fca">naaice_register_mrs</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="memdesc:gae242db34a7bfaea52853646886269fca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register local memory regions.  <br /></td></tr>
<tr class="separator:gae242db34a7bfaea52853646886269fca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac477d9f2f20410154089940519d29ff3" id="r_gac477d9f2f20410154089940519d29ff3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gac477d9f2f20410154089940519d29ff3">naaice_set_parameter_mrs</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx, unsigned int n_parameter_mrs, uint64_t *local_addrs, uint64_t *remote_addrs, size_t *sizes)</td></tr>
<tr class="memdesc:gac477d9f2f20410154089940519d29ff3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate and initialize parameter memory region descriptors.  <br /></td></tr>
<tr class="separator:gac477d9f2f20410154089940519d29ff3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga78223d8aa683630e139217773b9bf9b2" id="r_ga78223d8aa683630e139217773b9bf9b2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga78223d8aa683630e139217773b9bf9b2">naaice_set_input_mr</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx, unsigned int input_mr_idx)</td></tr>
<tr class="memdesc:ga78223d8aa683630e139217773b9bf9b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mark a memory region as input and/or output.  <br /></td></tr>
<tr class="separator:ga78223d8aa683630e139217773b9bf9b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf80665027802da485541cebd9cbe5570" id="r_gaf80665027802da485541cebd9cbe5570"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaf80665027802da485541cebd9cbe5570">naaice_set_output_mr</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx, unsigned int output_mr_idx)</td></tr>
<tr class="memdesc:gaf80665027802da485541cebd9cbe5570"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mark a memory region as an output parameter.  <br /></td></tr>
<tr class="separator:gaf80665027802da485541cebd9cbe5570"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3e0bb6d9854ad7e39a49fd5907d394da" id="r_ga3e0bb6d9854ad7e39a49fd5907d394da"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga3e0bb6d9854ad7e39a49fd5907d394da">naaice_set_singlesend_mr</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx, unsigned int singlesend_mr_idx)</td></tr>
<tr class="memdesc:ga3e0bb6d9854ad7e39a49fd5907d394da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mark a memory region as a single-send region.  <br /></td></tr>
<tr class="separator:ga3e0bb6d9854ad7e39a49fd5907d394da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6f329c9fac52b8c65c5b9d8441ca2065" id="r_ga6f329c9fac52b8c65c5b9d8441ca2065"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga6f329c9fac52b8c65c5b9d8441ca2065">naaice_set_internal_mrs</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx, unsigned int n_internal_mrs, uint64_t *addrs, size_t *sizes)</td></tr>
<tr class="memdesc:ga6f329c9fac52b8c65c5b9d8441ca2065"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add internal memory regions to the communication context.  <br /></td></tr>
<tr class="separator:ga6f329c9fac52b8c65c5b9d8441ca2065"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab1eaa0617fe2d1cd8f6a0248b9869283" id="r_gab1eaa0617fe2d1cd8f6a0248b9869283"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gab1eaa0617fe2d1cd8f6a0248b9869283">naaice_set_immediate</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx, uint8_t *imm_bytes)</td></tr>
<tr class="memdesc:gab1eaa0617fe2d1cd8f6a0248b9869283"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the immediate value for data transfer.  <br /></td></tr>
<tr class="separator:gab1eaa0617fe2d1cd8f6a0248b9869283"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3babb3d708aec505bfc0df1223acba28" id="r_ga3babb3d708aec505bfc0df1223acba28"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga3babb3d708aec505bfc0df1223acba28">naaice_init_mrsp</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="memdesc:ga3babb3d708aec505bfc0df1223acba28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the Memory Region Setup Protocol (MRSP).  <br /></td></tr>
<tr class="separator:ga3babb3d708aec505bfc0df1223acba28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacd927690e6d6b807be794b34878630d1" id="r_gacd927690e6d6b807be794b34878630d1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gacd927690e6d6b807be794b34878630d1">naaice_init_data_transfer</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="memdesc:gacd927690e6d6b807be794b34878630d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start the data transfer to the NAA.  <br /></td></tr>
<tr class="separator:gacd927690e6d6b807be794b34878630d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7a05d334df39718b31030442d172e1e6" id="r_ga7a05d334df39718b31030442d172e1e6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga7a05d334df39718b31030442d172e1e6">naaice_handle_work_completion</a> (struct ibv_wc *wc, struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="memdesc:ga7a05d334df39718b31030442d172e1e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle a single work completion from the completion queue.  <br /></td></tr>
<tr class="separator:ga7a05d334df39718b31030442d172e1e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf4a8fd1c6bbd8589868fa454c8f8c863" id="r_gaf4a8fd1c6bbd8589868fa454c8f8c863"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaf4a8fd1c6bbd8589868fa454c8f8c863">naaice_poll_cq_nonblocking</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="memdesc:gaf4a8fd1c6bbd8589868fa454c8f8c863"><td class="mdescLeft">&#160;</td><td class="mdescRight">Poll the completion queue non-blocking.  <br /></td></tr>
<tr class="separator:gaf4a8fd1c6bbd8589868fa454c8f8c863"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa6fdf267f0d16b71b1cde8f337332035" id="r_gaa6fdf267f0d16b71b1cde8f337332035"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa6fdf267f0d16b71b1cde8f337332035">naaice_poll_cq_blocking</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="memdesc:gaa6fdf267f0d16b71b1cde8f337332035"><td class="mdescLeft">&#160;</td><td class="mdescRight">Poll the completion queue blocking.  <br /></td></tr>
<tr class="separator:gaa6fdf267f0d16b71b1cde8f337332035"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga74338ed21867befe5820a7cde3d7a71c" id="r_ga74338ed21867befe5820a7cde3d7a71c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga74338ed21867befe5820a7cde3d7a71c">naaice_disconnect_and_cleanup</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="memdesc:ga74338ed21867befe5820a7cde3d7a71c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disconnect and clean up the communication context.  <br /></td></tr>
<tr class="separator:ga74338ed21867befe5820a7cde3d7a71c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8f0b77ff3c5376a9aa5b583c9cbf752b" id="r_ga8f0b77ff3c5376a9aa5b583c9cbf752b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga8f0b77ff3c5376a9aa5b583c9cbf752b">naaice_send_message</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx, enum <a class="el" href="naaice_8h.html#a5f2be45182f0cc39afb7cc3a8d55a1f1">message_id</a> message_type, uint8_t errorcode)</td></tr>
<tr class="memdesc:ga8f0b77ff3c5376a9aa5b583c9cbf752b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send an MRSP message to the remote peer.  <br /></td></tr>
<tr class="separator:ga8f0b77ff3c5376a9aa5b583c9cbf752b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadd7def5aad3326ca5c416ad0158c0c57" id="r_gadd7def5aad3326ca5c416ad0158c0c57"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gadd7def5aad3326ca5c416ad0158c0c57">naaice_write_data</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx, uint8_t fncode)</td></tr>
<tr class="memdesc:gadd7def5aad3326ca5c416ad0158c0c57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write memory regions to the NAA.  <br /></td></tr>
<tr class="separator:gadd7def5aad3326ca5c416ad0158c0c57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga83494efe81ac7802b6119438509e08fc" id="r_ga83494efe81ac7802b6119438509e08fc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga83494efe81ac7802b6119438509e08fc">naaice_post_recv_mrsp</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="memdesc:ga83494efe81ac7802b6119438509e08fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Post a receive request for an MRSP message.  <br /></td></tr>
<tr class="separator:ga83494efe81ac7802b6119438509e08fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad9227128ecee083b491749888b8ff8b9" id="r_gad9227128ecee083b491749888b8ff8b9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gad9227128ecee083b491749888b8ff8b9">naaice_post_recv_data</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="memdesc:gad9227128ecee083b491749888b8ff8b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Post a receive request for a memory region write.  <br /></td></tr>
<tr class="separator:gad9227128ecee083b491749888b8ff8b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaff209c1f0b59a45983c53f5698a25ed7" id="r_gaff209c1f0b59a45983c53f5698a25ed7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaff209c1f0b59a45983c53f5698a25ed7">naaice_init_rdma_resources</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="memdesc:gaff209c1f0b59a45983c53f5698a25ed7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize RDMA resources.  <br /></td></tr>
<tr class="separator:gaff209c1f0b59a45983c53f5698a25ed7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8b2194c5a28e85fe089be51e060a8435" id="r_ga8b2194c5a28e85fe089be51e060a8435"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga8b2194c5a28e85fe089be51e060a8435">naaice_do_mrsp</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="memdesc:ga8b2194c5a28e85fe089be51e060a8435"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute the MRSP protocol in a blocking manner.  <br /></td></tr>
<tr class="separator:ga8b2194c5a28e85fe089be51e060a8435"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga43e50e171eff94f88abab88963d3cd7a" id="r_ga43e50e171eff94f88abab88963d3cd7a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga43e50e171eff94f88abab88963d3cd7a">naaice_do_data_transfer</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx)</td></tr>
<tr class="memdesc:ga43e50e171eff94f88abab88963d3cd7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform the complete data transfer in a blocking manner.  <br /></td></tr>
<tr class="separator:ga43e50e171eff94f88abab88963d3cd7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga23fbc699ddcd9e7b8f292e225c7c9895" id="r_ga23fbc699ddcd9e7b8f292e225c7c9895"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga23fbc699ddcd9e7b8f292e225c7c9895">naaice_set_bytes_to_send</a> (struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *comm_ctx, int mr_idx, int number_bytes)</td></tr>
<tr class="memdesc:ga23fbc699ddcd9e7b8f292e225c7c9895"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the number of bytes to send from a memory region.  <br /></td></tr>
<tr class="separator:ga23fbc699ddcd9e7b8f292e225c7c9895"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga74338ed21867befe5820a7cde3d7a71c" name="ga74338ed21867befe5820a7cde3d7a71c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga74338ed21867befe5820a7cde3d7a71c">&#9670;&#160;</a></span>naaice_disconnect_and_cleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_disconnect_and_cleanup </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Disconnect and clean up the communication context. </p>
<p>Terminates the RDMA connection and frees all memory associated with the communication context.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">comm_ctx</td><td>Pointer to the communication context describing the connection.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure. </dd></dl>

</div>
</div>
<a id="ga43e50e171eff94f88abab88963d3cd7a" name="ga43e50e171eff94f88abab88963d3cd7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga43e50e171eff94f88abab88963d3cd7a">&#9670;&#160;</a></span>naaice_do_data_transfer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_do_data_transfer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform the complete data transfer in a blocking manner. </p>
<p>Executes all steps of the data transfer, including writing data to the NAA, waiting for the NAA to complete computation, and receiving the resulting data back. This function operates in a blocking fashion.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">comm_ctx</td><td>Pointer to the communication context describing the connection.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure. </dd></dl>

</div>
</div>
<a id="ga8b2194c5a28e85fe089be51e060a8435" name="ga8b2194c5a28e85fe089be51e060a8435"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8b2194c5a28e85fe089be51e060a8435">&#9670;&#160;</a></span>naaice_do_mrsp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_do_mrsp </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Execute the MRSP protocol in a blocking manner. </p>
<p>Performs all steps of the Memory Region Setup Protocol (MRSP) in a blocking fashion, ensuring that memory regions are properly advertised, requested, and acknowledged before returning.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">comm_ctx</td><td>Pointer to the communication context describing the connection.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure. </dd></dl>

</div>
</div>
<a id="ga7a05d334df39718b31030442d172e1e6" name="ga7a05d334df39718b31030442d172e1e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7a05d334df39718b31030442d172e1e6">&#9670;&#160;</a></span>naaice_handle_work_completion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_handle_work_completion </td>
          <td>(</td>
          <td class="paramtype">struct ibv_wc *</td>          <td class="paramname"><span class="paramname"><em>wc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle a single work completion from the completion queue. </p>
<p>Processes a single work completion event from the completion queue, which typically represents a memory region write either from the host to the NAA or from the NAA to the host.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">comm_ctx</td><td>Pointer to the communication context describing the connection.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure. </dd></dl>

</div>
</div>
<a id="ga6f3ba43a0744d3118a6fb194503eb63e" name="ga6f3ba43a0744d3118a6fb194503eb63e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6f3ba43a0744d3118a6fb194503eb63e">&#9670;&#160;</a></span>naaice_init_communication_context()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_init_communication_context </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> **</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>addr_offset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>param_sizes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int</td>          <td class="paramname"><span class="paramname"><em>params_amount</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int</td>          <td class="paramname"><span class="paramname"><em>internal_mr_amount</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>internal_mr_sizes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>fncode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>local_address</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>remote_address</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>port</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes communication context struct. </p>
<p>After a call to this function, the provided communication context struct is ready to be passed to all other API functions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">comm_ctx</td><td>Double pointer to communication context struct to be initialized. Must not point to an existing struct; the struct is allocated and returned by this function.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">param_sizes</td><td>Array of sizes (in bytes) of the provided routine parameters.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">params</td><td>Array of pointers to parameter data. Must be preallocated by the host application.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">params_amount</td><td>Number of parameters. Used to index <code class="param">param_sizes</code> and <code class="param">params</code>.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">internal_mr_amount</td><td>Number of internal memory regions. Used to index <code class="param">internal_mr_sizes</code>.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">internal_mr_sizes</td><td>Array of sizes (in bytes) of the internal memory regions.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">fncode</td><td>Function code specifying which NAA routine is called.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">local_address</td><td>Local address string (e.g. "10.3.10.136"). Optional; if NULL, it is not used. Do not provide a local address when running in loopback mode.</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">remote_address</td><td>Remote address string (e.g. "10.3.10.135").</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">port</td><td>Connection port. A value of 0 enables dynamic port allocation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure. </dd></dl>

</div>
</div>
<a id="gacd927690e6d6b807be794b34878630d1" name="gacd927690e6d6b807be794b34878630d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacd927690e6d6b807be794b34878630d1">&#9670;&#160;</a></span>naaice_init_data_transfer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_init_data_transfer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start the data transfer to the NAA. </p>
<p>Initiates the data transfer by posting write operations for the memory regions to the NAA. Prepares the connection for remote computation using the previously registered memory regions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">comm_ctx</td><td>Pointer to the communication context describing the connection and associated memory regions.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure. </dd></dl>

</div>
</div>
<a id="ga3babb3d708aec505bfc0df1223acba28" name="ga3babb3d708aec505bfc0df1223acba28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3babb3d708aec505bfc0df1223acba28">&#9670;&#160;</a></span>naaice_init_mrsp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_init_mrsp </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the Memory Region Setup Protocol (MRSP). </p>
<p>Starts the MRSP by sending advertise/request packets and posting a receive for the response. This prepares the connection for memory region registration and data transfer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">comm_ctx</td><td>Pointer to the communication context describing the connection and associated memory regions.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure. </dd></dl>

</div>
</div>
<a id="gaff209c1f0b59a45983c53f5698a25ed7" name="gaff209c1f0b59a45983c53f5698a25ed7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaff209c1f0b59a45983c53f5698a25ed7">&#9670;&#160;</a></span>naaice_init_rdma_resources()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_init_rdma_resources </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize RDMA resources. </p>
<p>Allocates and initializes the necessary RDMA resources, including a protection domain, completion channel, completion queue, and queue pair.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">comm_ctx</td><td>Pointer to the communication context describing the connection.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure. </dd></dl>

</div>
</div>
<a id="ga241fe974872b43327aa2bb3f8fcf56c9" name="ga241fe974872b43327aa2bb3f8fcf56c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga241fe974872b43327aa2bb3f8fcf56c9">&#9670;&#160;</a></span>naaice_poll_and_handle_connection_event()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_poll_and_handle_connection_event </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Poll and handle a connection event on the RDMA event channel. </p>
<p>Polls the RDMA event channel stored in the communication context and, if an event is received, dispatches it to the appropriate connection event handler. This function is a convenience wrapper that combines polling and handling using the previously defined poll and handler functions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">comm_ctx</td><td>Pointer to the communication context describing the connection.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success (regardless of whether an event was received), -1 on failure. </dd></dl>

</div>
</div>
<a id="gaf2fe88c227bab4e0722365efc2dba892" name="gaf2fe88c227bab4e0722365efc2dba892"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf2fe88c227bab4e0722365efc2dba892">&#9670;&#160;</a></span>naaice_poll_connection_event()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_poll_connection_event </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct rdma_cm_event *</td>          <td class="paramname"><span class="paramname"><em>ev</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct rdma_cm_event *</td>          <td class="paramname"><span class="paramname"><em>ev_cp</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Polls for a connection event on the RDMA event channel. </p>
<p>Polls the RDMA event channel stored in the communication context. If a connection event is received, it is stored in the provided event pointer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">comm_ctx</td><td>Pointer to the communication context describing the connection to be polled.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ev</td><td>Pointer to the received RDMA connection event.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success (regardless of whether an event was received), -1 on failure. </dd></dl>

</div>
</div>
<a id="gaa6fdf267f0d16b71b1cde8f337332035" name="gaa6fdf267f0d16b71b1cde8f337332035"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa6fdf267f0d16b71b1cde8f337332035">&#9670;&#160;</a></span>naaice_poll_cq_blocking()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_poll_cq_blocking </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Poll the completion queue blocking. </p>
<p>Polls the completion queue for a work completion and blocks until at least one completion is available. Once a completion is received, it is processed using <a class="el" href="#ga7a05d334df39718b31030442d172e1e6" title="Handle a single work completion from the completion queue.">naaice_handle_work_completion</a>. After handling, ::comm_ctx-&gt;state is updated to reflect the current state of the NAA connection and routine.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">comm_ctx</td><td>Pointer to the communication context describing the connection.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success (regardless of whether any work completions were received), -1 on failure. </dd></dl>

</div>
</div>
<a id="gaf4a8fd1c6bbd8589868fa454c8f8c863" name="gaf4a8fd1c6bbd8589868fa454c8f8c863"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf4a8fd1c6bbd8589868fa454c8f8c863">&#9670;&#160;</a></span>naaice_poll_cq_nonblocking()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_poll_cq_nonblocking </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Poll the completion queue non-blocking. </p>
<p>Polls the completion queue for any work completions and processes them using <a class="el" href="#ga7a05d334df39718b31030442d172e1e6" title="Handle a single work completion from the completion queue.">naaice_handle_work_completion</a> if any are received. After handling, updates ::comm_ctx-&gt;state to reflect the current state of the NAA connection and routine.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">comm_ctx</td><td>Pointer to the communication context describing the connection.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success (regardless of whether any work completions were received), -1 on failure. </dd></dl>

</div>
</div>
<a id="gad9227128ecee083b491749888b8ff8b9" name="gad9227128ecee083b491749888b8ff8b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad9227128ecee083b491749888b8ff8b9">&#9670;&#160;</a></span>naaice_post_recv_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_post_recv_data </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Post a receive request for a memory region write. </p>
<p>Posts a receive request for a memory region write. Only the final memory region write (the one with an immediate value) requires a receive request; regular RDMA writes without an immediate do not consume a receive request.</p>
<p>The memory region specified in the receive request is the MRSP region. This is a placeholder, as the actual region written to is determined by the sender.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">comm_ctx</td><td>Pointer to the communication context describing the connection.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure. </dd></dl>

</div>
</div>
<a id="ga83494efe81ac7802b6119438509e08fc" name="ga83494efe81ac7802b6119438509e08fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga83494efe81ac7802b6119438509e08fc">&#9670;&#160;</a></span>naaice_post_recv_mrsp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_post_recv_mrsp </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Post a receive request for an MRSP message. </p>
<p>Posts a receive request to the completion queue for an MRSP message. The request specifies the memory region to be written to (the MRSP region in this case).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">comm_ctx</td><td>Pointer to the communication context describing the connection.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure. </dd></dl>

</div>
</div>
<a id="gae242db34a7bfaea52853646886269fca" name="gae242db34a7bfaea52853646886269fca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae242db34a7bfaea52853646886269fca">&#9670;&#160;</a></span>naaice_register_mrs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_register_mrs </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register local memory regions. </p>
<p>Registers local memory regions as IBV memory regions using ::ibv_reg_mr. This includes memory regions corresponding to input and output parameters, the single metadata memory region, and the memory region used for MRSP.</p>
<p>If an error occurs during registration, the remote peer is notified via <a class="el" href="#ga8f0b77ff3c5376a9aa5b583c9cbf752b" title="Send an MRSP message to the remote peer.">naaice_send_message</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">comm_ctx</td><td>Pointer to the communication context describing the connection and associated memory regions.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure. </dd></dl>

</div>
</div>
<a id="ga8f0b77ff3c5376a9aa5b583c9cbf752b" name="ga8f0b77ff3c5376a9aa5b583c9cbf752b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8f0b77ff3c5376a9aa5b583c9cbf752b">&#9670;&#160;</a></span>naaice_send_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_send_message </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="naaice_8h.html#a5f2be45182f0cc39afb7cc3a8d55a1f1">message_id</a></td>          <td class="paramname"><span class="paramname"><em>message_type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>errorcode</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send an MRSP message to the remote peer. </p>
<p>Sends an MRSP packet to the remote peer using ::ibv_post_send with opcode ::IBV_WR_SEND.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">comm_ctx</td><td>Pointer to the communication context describing the connection.</td></tr>
    <tr><td class="paramname">message_type</td><td>Type of message to send. Should be one of <a class="el" href="naaice_8h.html#a5f2be45182f0cc39afb7cc3a8d55a1f1a8fd265e7fd63cf70cfc8e61d515c7660" title="Error message.">MSG_MR_ERR</a>, <a class="el" href="naaice_8h.html#a5f2be45182f0cc39afb7cc3a8d55a1f1a2452686f8cba3b6595541692c6090f63" title="Memory region advertisement and request, sent by host.">MSG_MR_AAR</a>, or <a class="el" href="naaice_8h.html#a5f2be45182f0cc39afb7cc3a8d55a1f1a509feadbdb916483a76b424927cf5774" title="Memory region advertisement without request, usually sent by NAA.">MSG_MR_A</a>.</td></tr>
    <tr><td class="paramname">errorcode</td><td>Error code to include in the packet if <code class="param">message_type</code> is <a class="el" href="naaice_8h.html#a5f2be45182f0cc39afb7cc3a8d55a1f1a8fd265e7fd63cf70cfc8e61d515c7660" title="Error message.">MSG_MR_ERR</a>. Ignored for other message types.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure. </dd></dl>

</div>
</div>
<a id="ga23fbc699ddcd9e7b8f292e225c7c9895" name="ga23fbc699ddcd9e7b8f292e225c7c9895"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga23fbc699ddcd9e7b8f292e225c7c9895">&#9670;&#160;</a></span>naaice_set_bytes_to_send()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_set_bytes_to_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>mr_idx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>number_bytes</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the number of bytes to send from a memory region. </p>
<p>Specifies how many bytes should be sent from the given memory region during data transfer. Passing 0 resets the size to the original size of the memory region.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">comm_ctx</td><td>Pointer to the communication context describing the connection.</td></tr>
    <tr><td class="paramname">mr_idx</td><td>Index of the memory region to be modified.</td></tr>
    <tr><td class="paramname">number_bytes</td><td>Number of bytes to send from the specified memory region. 0 resets to the original size.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure. </dd></dl>

</div>
</div>
<a id="gab1eaa0617fe2d1cd8f6a0248b9869283" name="gab1eaa0617fe2d1cd8f6a0248b9869283"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab1eaa0617fe2d1cd8f6a0248b9869283">&#9670;&#160;</a></span>naaice_set_immediate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_set_immediate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>imm_bytes</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the immediate value for data transfer. </p>
<p>Sets the immediate value to be written during data transfer. The immediate consists of up to 3 user-specified bytes placed in the upper 3 bytes; the lowest byte is reserved for the function code.</p>
<p>This function must be called before <a class="el" href="#gacd927690e6d6b807be794b34878630d1" title="Start the data transfer to the NAA.">naaice_init_data_transfer</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">comm_ctx</td><td>Pointer to the communication context describing the connection.</td></tr>
    <tr><td class="paramname">imm_bytes</td><td>Array of immediate value bytes. Maximum of 3 bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure. </dd></dl>

</div>
</div>
<a id="ga78223d8aa683630e139217773b9bf9b2" name="ga78223d8aa683630e139217773b9bf9b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga78223d8aa683630e139217773b9bf9b2">&#9670;&#160;</a></span>naaice_set_input_mr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_set_input_mr </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int</td>          <td class="paramname"><span class="paramname"><em>input_mr_idx</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mark a memory region as input and/or output. </p>
<p>Adds information to the communication context indicating whether a memory region contains an input parameter, an output parameter, or both. Input memory regions are written to the NAA during data transfer, while output memory regions are written back from the NAA.</p>
<p>This function must be called before <a class="el" href="#ga3babb3d708aec505bfc0df1223acba28" title="Initialize the Memory Region Setup Protocol (MRSP).">naaice_init_mrsp</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">comm_ctx</td><td>Pointer to the communication context describing the connection.</td></tr>
    <tr><td class="paramname">idx</td><td>Index of the memory region to be marked as input or output.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure.</dd></dl>
<p>Mark a memory region as an input parameter. </p>

</div>
</div>
<a id="ga6f329c9fac52b8c65c5b9d8441ca2065" name="ga6f329c9fac52b8c65c5b9d8441ca2065"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6f329c9fac52b8c65c5b9d8441ca2065">&#9670;&#160;</a></span>naaice_set_internal_mrs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_set_internal_mrs </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int</td>          <td class="paramname"><span class="paramname"><em>n_internal_mrs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *</td>          <td class="paramname"><span class="paramname"><em>addrs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>sizes</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add internal memory regions to the communication context. </p>
<p>Adds information about internal memory regions to the communication context. Internal memory regions exist only on the NAA side and are used for computation; their contents are not communicated during data transfer.</p>
<p>This function must be called before <a class="el" href="#ga3babb3d708aec505bfc0df1223acba28" title="Initialize the Memory Region Setup Protocol (MRSP).">naaice_init_mrsp</a>. The internal memory regions will be included in the memory region announcement message, indicating that they should be allocated by the NAA.</p>
<p>Should only be called once per communication context. Each call overwrites any previous internal memory region information.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">comm_ctx</td><td>Pointer to the communication context describing the connection.</td></tr>
    <tr><td class="paramname">n_internal_mrs</td><td>Number of internal memory regions.</td></tr>
    <tr><td class="paramname">addrs</td><td>Array of addresses of the internal memory regions in NAA memory space. These addresses will be requested of the NAA during MRSP.</td></tr>
    <tr><td class="paramname">sizes</td><td>Array of sizes (in bytes) of the internal memory regions.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure. </dd></dl>

</div>
</div>
<a id="gaf80665027802da485541cebd9cbe5570" name="gaf80665027802da485541cebd9cbe5570"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf80665027802da485541cebd9cbe5570">&#9670;&#160;</a></span>naaice_set_output_mr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_set_output_mr </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int</td>          <td class="paramname"><span class="paramname"><em>output_mr_idx</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mark a memory region as an output parameter. </p>

</div>
</div>
<a id="gac477d9f2f20410154089940519d29ff3" name="gac477d9f2f20410154089940519d29ff3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac477d9f2f20410154089940519d29ff3">&#9670;&#160;</a></span>naaice_set_parameter_mrs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_set_parameter_mrs </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int</td>          <td class="paramname"><span class="paramname"><em>n_parameter_mrs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *</td>          <td class="paramname"><span class="paramname"><em>local_addrs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *</td>          <td class="paramname"><span class="paramname"><em>remote_addrs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>sizes</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate and initialize parameter memory region descriptors. </p>
<p>Allocates and initializes internal structures for parameter (i.e. non-internal) memory regions. This function is called from <a class="el" href="#ga6f3ba43a0744d3118a6fb194503eb63e" title="Initializes communication context struct.">naaice_init_communication_context</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">comm_ctx</td><td>Pointer to the communication context describing the connection and memory regions.</td></tr>
    <tr><td class="paramname">n_parameter_mrs</td><td>Number of parameter memory regions for which descriptors will be allocated.</td></tr>
    <tr><td class="paramname">local_addrs</td><td>Array of local (user-space) addresses of the memory regions. This should correspond to the <code class="param">params</code> array passed to <a class="el" href="#ga6f3ba43a0744d3118a6fb194503eb63e" title="Initializes communication context struct.">naaice_init_communication_context</a>.</td></tr>
    <tr><td class="paramname">remote_addrs</td><td>Array of remote addresses in NAA memory where the memory regions are requested to be stored. These addresses are obtained from the memory management service.</td></tr>
    <tr><td class="paramname">sizes</td><td>Array of sizes (in bytes) of the memory regions. This should correspond to the <code class="param">param_sizes</code> array passed to <a class="el" href="#ga6f3ba43a0744d3118a6fb194503eb63e" title="Initializes communication context struct.">naaice_init_communication_context</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure. </dd></dl>

</div>
</div>
<a id="ga3e0bb6d9854ad7e39a49fd5907d394da" name="ga3e0bb6d9854ad7e39a49fd5907d394da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3e0bb6d9854ad7e39a49fd5907d394da">&#9670;&#160;</a></span>naaice_set_singlesend_mr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_set_singlesend_mr </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int</td>          <td class="paramname"><span class="paramname"><em>singlesend_mr_idx</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mark a memory region as a single-send region. </p>
<p>Adds information to the communication context indicating that a memory region is a single-send region. Single-send regions are written exactly once during the first RPC on a connection and are not written again during subsequent RPCs.</p>
<p>If the memory region is not already marked as an input region, it is automatically marked as one.</p>
<p>This function must be called before <a class="el" href="#ga3babb3d708aec505bfc0df1223acba28" title="Initialize the Memory Region Setup Protocol (MRSP).">naaice_init_mrsp</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">comm_ctx</td><td>Pointer to the communication context describing the connection.</td></tr>
    <tr><td class="paramname">idx</td><td>Index of the memory region to be marked as a single-send region.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure. </dd></dl>

</div>
</div>
<a id="ga41cae89395d0303a73aa675c9be5ed05" name="ga41cae89395d0303a73aa675c9be5ed05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga41cae89395d0303a73aa675c9be5ed05">&#9670;&#160;</a></span>naaice_setup_connection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_setup_connection </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up the RDMA connection. </p>
<p>Repeatedly polls for and handles RDMA connection events until the connection setup is complete. This function is a blocking helper that internally calls <a class="el" href="#ga241fe974872b43327aa2bb3f8fcf56c9" title="Poll and handle a connection event on the RDMA event channel.">naaice_poll_and_handle_connection_event</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">comm_ctx</td><td>Pointer to the communication context describing the connection.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure (e.g. due to timeout). </dd></dl>

</div>
</div>
<a id="gadd7def5aad3326ca5c416ad0158c0c57" name="gadd7def5aad3326ca5c416ad0158c0c57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadd7def5aad3326ca5c416ad0158c0c57">&#9670;&#160;</a></span>naaice_write_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int naaice_write_data </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnaaice__communication__context.html">naaice_communication_context</a> *</td>          <td class="paramname"><span class="paramname"><em>comm_ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>fncode</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write memory regions to the NAA. </p>
<p>Writes memory regions, including metadata and input parameters, to the NAA. Uses ::ibv_post_send with opcode ::IBV_WR_RDMA_WRITE for regular regions or ::IBV_WR_RDMA_WRITE_WITH_IMM for the final memory region.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">comm_ctx</td><td>Pointer to the communication context describing the connection.</td></tr>
    <tr><td class="paramname">fncode</td><td>Function code for the NAA routine. Must be positive; 0 indicates an error.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2
</small></address>
</div><!-- doc-content -->
</body>
</html>
